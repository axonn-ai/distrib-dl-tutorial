mpirun -np 1 python train_ddp.py --num-layers 4 --hidden-size 2048 --data-dir /home/sathwik7/scratch.bhatele-lab/tutorial-venv --batch-size 32 --lr 0.001 --image-size 64 --checkpoint-activations
--------------------------------------------------------------------------
The library attempted to open the following supporting CUDA libraries,
but each of them failed.  CUDA-aware support is disabled.
libcuda.so.1: cannot open shared object file: No such file or directory
libcuda.dylib: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.so.1: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.dylib: cannot open shared object file: No such file or directory
If you are not interested in CUDA-aware support, then run with
--mca opal_warn_on_missing_libcuda 0 to suppress this message.  If you are interested
in CUDA-aware support, then try setting LD_LIBRARY_PATH to the location
of libcuda.so.1 to get passed this issue.
--------------------------------------------------------------------------
Rank 0 : initialized pytorch dist
Rank 0 : Model Size = 0.142686218 B
Rank 0 : Start training with DDP...

Rank 0 : Epoch 0 | Iter 0/1875 | Iter Train Loss = 2.384 | Iter Time = 2.824478 s
Rank 0 : Epoch 0 | Iter 200/1875 | Iter Train Loss = 1.001 | Iter Time = 2.505979 s
Rank 0 : Epoch 0 | Iter 400/1875 | Iter Train Loss = 0.782 | Iter Time = 2.493161 s
Rank 0 : Epoch 0 | Iter 600/1875 | Iter Train Loss = 0.611 | Iter Time = 2.485544 s
Rank 0 : Epoch 0 | Iter 800/1875 | Iter Train Loss = 0.486 | Iter Time = 2.484260 s
Rank 0 : Epoch 0 | Iter 1000/1875 | Iter Train Loss = 0.571 | Iter Time = 2.488605 s
Rank 0 : Epoch 0 | Iter 1200/1875 | Iter Train Loss = 0.382 | Iter Time = 2.490080 s
Rank 0 : Epoch 0 | Iter 1400/1875 | Iter Train Loss = 0.454 | Iter Time = 2.483603 s
Rank 0 : Epoch 0 | Iter 1600/1875 | Iter Train Loss = 0.500 | Iter Time = 2.488167 s
Rank 0 : Epoch 0 | Iter 1800/1875 | Iter Train Loss = 0.169 | Iter Time = 2.479860 s
Rank 0 : Epoch 0 : Epoch Train Loss= 0.823 | Average Iter Time = 2.486153 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 1 | Iter 0/1875 | Iter Train Loss = 0.464 | Iter Time = 3.267799 s
Rank 0 : Epoch 1 | Iter 200/1875 | Iter Train Loss = 0.713 | Iter Time = 2.488339 s
Rank 0 : Epoch 1 | Iter 400/1875 | Iter Train Loss = 0.166 | Iter Time = 2.488922 s
Rank 0 : Epoch 1 | Iter 600/1875 | Iter Train Loss = 0.402 | Iter Time = 2.485608 s
Rank 0 : Epoch 1 | Iter 800/1875 | Iter Train Loss = 0.453 | Iter Time = 2.491794 s
Rank 0 : Epoch 1 | Iter 1000/1875 | Iter Train Loss = 0.458 | Iter Time = 2.487367 s
slurmstepd: error: *** JOB 4344888 ON compute-a7-25 CANCELLED AT 2023-12-13T01:04:06 DUE TO TIME LIMIT ***
