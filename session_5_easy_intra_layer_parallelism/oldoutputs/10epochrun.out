srun -n 4 python train.py --num-layers 4 --hidden-size 2048 --data-dir /home/sathwik7/scratch.bhatele-lab/tutorial-venv --batch-size 32 --lr 0.0001 --image-size 64 --G-intra-r 2 --G-intra-c 2 --G-data 1 --micro-batch-size 4 --device cpu --checkpoint-activations
--------------------------------------------------------------------------
The library attempted to open the following supporting CUDA libraries,
but each of them failed.  CUDA-aware support is disabled.
libcuda.so.1: cannot open shared object file: No such file or directory
libcuda.dylib: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.so.1: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.dylib: cannot open shared object file: No such file or directory
If you are not interested in CUDA-aware support, then run with
--mca opal_warn_on_missing_libcuda 0 to suppress this message.  If you are interested
in CUDA-aware support, then try setting LD_LIBRARY_PATH to the location
of libcuda.so.1 to get passed this issue.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
The library attempted to open the following supporting CUDA libraries,
but each of them failed.  CUDA-aware support is disabled.
libcuda.so.1: cannot open shared object file: No such file or directory
libcuda.dylib: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.so.1: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.dylib: cannot open shared object file: No such file or directory
If you are not interested in CUDA-aware support, then run with
--mca opal_warn_on_missing_libcuda 0 to suppress this message.  If you are interested
in CUDA-aware support, then try setting LD_LIBRARY_PATH to the location
of libcuda.so.1 to get passed this issue.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
The library attempted to open the following supporting CUDA libraries,
but each of them failed.  CUDA-aware support is disabled.
libcuda.so.1: cannot open shared object file: No such file or directory
libcuda.dylib: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.so.1: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.dylib: cannot open shared object file: No such file or directory
If you are not interested in CUDA-aware support, then run with
--mca opal_warn_on_missing_libcuda 0 to suppress this message.  If you are interested
in CUDA-aware support, then try setting LD_LIBRARY_PATH to the location
of libcuda.so.1 to get passed this issue.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
The library attempted to open the following supporting CUDA libraries,
but each of them failed.  CUDA-aware support is disabled.
libcuda.so.1: cannot open shared object file: No such file or directory
libcuda.dylib: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.so.1: cannot open shared object file: No such file or directory
/usr/lib64/libcuda.dylib: cannot open shared object file: No such file or directory
If you are not interested in CUDA-aware support, then run with
--mca opal_warn_on_missing_libcuda 0 to suppress this message.  If you are interested
in CUDA-aware support, then try setting LD_LIBRARY_PATH to the location
of libcuda.so.1 to get passed this issue.
--------------------------------------------------------------------------
is this the first thing that runs
cpu
cpu
maybe its this
Rank 0 : initialized AxoNN
Rank 0 : Model Params = 0.168009768 B
Rank 0 : Start Training with AxoNN's Intra-Layer Parallelism
is this the first thing that runs
cpu
cpu
maybe its this
is this the first thing that runs
cpu
cpu
maybe its this
is this the first thing that runs
cpu
cpu
maybe its this
Rank 0 : Epoch 0 | Iter 0/1875 | Iter Train Loss = 2.308 | Iter Time = 1.089602 s
Rank 0 : Epoch 0 | Iter 200/1875 | Iter Train Loss = 0.685 | Iter Time = 0.570860 s
Rank 0 : Epoch 0 | Iter 400/1875 | Iter Train Loss = 0.364 | Iter Time = 0.569276 s
Rank 0 : Epoch 0 | Iter 600/1875 | Iter Train Loss = 0.223 | Iter Time = 0.535630 s
Rank 0 : Epoch 0 | Iter 800/1875 | Iter Train Loss = 0.307 | Iter Time = 0.555455 s
Rank 0 : Epoch 0 | Iter 1000/1875 | Iter Train Loss = 0.245 | Iter Time = 0.564195 s
Rank 0 : Epoch 0 | Iter 1200/1875 | Iter Train Loss = 0.116 | Iter Time = 0.490739 s
Rank 0 : Epoch 0 | Iter 1400/1875 | Iter Train Loss = 0.097 | Iter Time = 0.539112 s
Rank 0 : Epoch 0 | Iter 1600/1875 | Iter Train Loss = 0.084 | Iter Time = 0.618192 s
Rank 0 : Epoch 0 | Iter 1800/1875 | Iter Train Loss = 0.130 | Iter Time = 0.492601 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 0 : Epoch Train Loss= 0.308 | Average Iter Time = 0.571787 s
Rank 0 : End Training ...
Rank 0 : Epoch 1 | Iter 0/1875 | Iter Train Loss = 0.336 | Iter Time = 1.152099 s
Rank 0 : Epoch 1 | Iter 200/1875 | Iter Train Loss = 0.102 | Iter Time = 0.571403 s
Rank 0 : Epoch 1 | Iter 400/1875 | Iter Train Loss = 0.085 | Iter Time = 0.564330 s
Rank 0 : Epoch 1 | Iter 600/1875 | Iter Train Loss = 0.174 | Iter Time = 0.610526 s
Rank 0 : Epoch 1 | Iter 800/1875 | Iter Train Loss = 0.097 | Iter Time = 0.625842 s
Rank 0 : Epoch 1 | Iter 1000/1875 | Iter Train Loss = 0.068 | Iter Time = 0.482479 s
Rank 0 : Epoch 1 | Iter 1200/1875 | Iter Train Loss = 0.037 | Iter Time = 0.521537 s
Rank 0 : Epoch 1 | Iter 1400/1875 | Iter Train Loss = 0.057 | Iter Time = 0.542496 s
Rank 0 : Epoch 1 | Iter 1600/1875 | Iter Train Loss = 0.070 | Iter Time = 0.557420 s
Rank 0 : Epoch 1 | Iter 1800/1875 | Iter Train Loss = 0.101 | Iter Time = 0.545213 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 1 : Epoch Train Loss= 0.169 | Average Iter Time = 0.564694 s
Rank 0 : End Training ...
Rank 0 : Epoch 2 | Iter 0/1875 | Iter Train Loss = 0.090 | Iter Time = 1.188037 s
Rank 0 : Epoch 2 | Iter 200/1875 | Iter Train Loss = 0.273 | Iter Time = 0.538087 s
Rank 0 : Epoch 2 | Iter 400/1875 | Iter Train Loss = 0.084 | Iter Time = 0.768803 s
Rank 0 : Epoch 2 | Iter 600/1875 | Iter Train Loss = 0.024 | Iter Time = 0.720678 s
Rank 0 : Epoch 2 | Iter 800/1875 | Iter Train Loss = 0.102 | Iter Time = 0.566259 s
Rank 0 : Epoch 2 | Iter 1000/1875 | Iter Train Loss = 0.141 | Iter Time = 0.648474 s
Rank 0 : Epoch 2 | Iter 1200/1875 | Iter Train Loss = 0.027 | Iter Time = 0.586499 s
Rank 0 : Epoch 2 | Iter 1400/1875 | Iter Train Loss = 0.057 | Iter Time = 0.589492 s
Rank 0 : Epoch 2 | Iter 1600/1875 | Iter Train Loss = 0.101 | Iter Time = 0.592441 s
Rank 0 : Epoch 2 | Iter 1800/1875 | Iter Train Loss = 0.144 | Iter Time = 0.540415 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 2 : Epoch Train Loss= 0.132 | Average Iter Time = 0.579873 s
Rank 0 : End Training ...
Rank 0 : Epoch 3 | Iter 0/1875 | Iter Train Loss = 0.029 | Iter Time = 1.058729 s
Rank 0 : Epoch 3 | Iter 200/1875 | Iter Train Loss = 0.067 | Iter Time = 0.575216 s
Rank 0 : Epoch 3 | Iter 400/1875 | Iter Train Loss = 0.029 | Iter Time = 0.580502 s
Rank 0 : Epoch 3 | Iter 600/1875 | Iter Train Loss = 0.058 | Iter Time = 0.592450 s
Rank 0 : Epoch 3 | Iter 800/1875 | Iter Train Loss = 0.120 | Iter Time = 0.574539 s
Rank 0 : Epoch 3 | Iter 1000/1875 | Iter Train Loss = 0.054 | Iter Time = 0.724970 s
Rank 0 : Epoch 3 | Iter 1200/1875 | Iter Train Loss = 0.015 | Iter Time = 0.529941 s
Rank 0 : Epoch 3 | Iter 1400/1875 | Iter Train Loss = 0.007 | Iter Time = 0.596217 s
Rank 0 : Epoch 3 | Iter 1600/1875 | Iter Train Loss = 0.040 | Iter Time = 0.484422 s
Rank 0 : Epoch 3 | Iter 1800/1875 | Iter Train Loss = 0.237 | Iter Time = 0.530167 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 3 : Epoch Train Loss= 0.115 | Average Iter Time = 0.587957 s
Rank 0 : End Training ...
Rank 0 : Epoch 4 | Iter 0/1875 | Iter Train Loss = 0.092 | Iter Time = 1.097787 s
Rank 0 : Epoch 4 | Iter 200/1875 | Iter Train Loss = 0.094 | Iter Time = 0.589956 s
Rank 0 : Epoch 4 | Iter 400/1875 | Iter Train Loss = 0.018 | Iter Time = 0.559937 s
Rank 0 : Epoch 4 | Iter 600/1875 | Iter Train Loss = 0.113 | Iter Time = 0.573555 s
Rank 0 : Epoch 4 | Iter 800/1875 | Iter Train Loss = 0.104 | Iter Time = 0.593328 s
Rank 0 : Epoch 4 | Iter 1000/1875 | Iter Train Loss = 0.052 | Iter Time = 0.613208 s
Rank 0 : Epoch 4 | Iter 1200/1875 | Iter Train Loss = 0.109 | Iter Time = 0.546018 s
Rank 0 : Epoch 4 | Iter 1400/1875 | Iter Train Loss = 0.017 | Iter Time = 0.565840 s
Rank 0 : Epoch 4 | Iter 1600/1875 | Iter Train Loss = 0.037 | Iter Time = 0.578882 s
Rank 0 : Epoch 4 | Iter 1800/1875 | Iter Train Loss = 0.064 | Iter Time = 0.556490 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 4 : Epoch Train Loss= 0.102 | Average Iter Time = 0.576505 s
Rank 0 : End Training ...
Rank 0 : Epoch 5 | Iter 0/1875 | Iter Train Loss = 0.138 | Iter Time = 1.078735 s
Rank 0 : Epoch 5 | Iter 200/1875 | Iter Train Loss = 0.115 | Iter Time = 0.535926 s
Rank 0 : Epoch 5 | Iter 400/1875 | Iter Train Loss = 0.150 | Iter Time = 0.573758 s
Rank 0 : Epoch 5 | Iter 600/1875 | Iter Train Loss = 0.058 | Iter Time = 0.516235 s
Rank 0 : Epoch 5 | Iter 800/1875 | Iter Train Loss = 0.014 | Iter Time = 0.582595 s
Rank 0 : Epoch 5 | Iter 1000/1875 | Iter Train Loss = 0.090 | Iter Time = 0.595545 s
Rank 0 : Epoch 5 | Iter 1200/1875 | Iter Train Loss = 0.014 | Iter Time = 0.577025 s
Rank 0 : Epoch 5 | Iter 1400/1875 | Iter Train Loss = 0.101 | Iter Time = 0.685697 s
Rank 0 : Epoch 5 | Iter 1600/1875 | Iter Train Loss = 0.009 | Iter Time = 0.496902 s
Rank 0 : Epoch 5 | Iter 1800/1875 | Iter Train Loss = 0.105 | Iter Time = 0.510790 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 5 : Epoch Train Loss= 0.093 | Average Iter Time = 0.570655 s
Rank 0 : End Training ...
Rank 0 : Epoch 6 | Iter 0/1875 | Iter Train Loss = 0.078 | Iter Time = 1.081449 s
Rank 0 : Epoch 6 | Iter 200/1875 | Iter Train Loss = 0.125 | Iter Time = 0.604527 s
Rank 0 : Epoch 6 | Iter 400/1875 | Iter Train Loss = 0.004 | Iter Time = 0.562829 s
Rank 0 : Epoch 6 | Iter 600/1875 | Iter Train Loss = 0.222 | Iter Time = 0.534707 s
Rank 0 : Epoch 6 | Iter 800/1875 | Iter Train Loss = 0.127 | Iter Time = 0.548195 s
Rank 0 : Epoch 6 | Iter 1000/1875 | Iter Train Loss = 0.026 | Iter Time = 0.558859 s
Rank 0 : Epoch 6 | Iter 1200/1875 | Iter Train Loss = 0.041 | Iter Time = 0.553967 s
Rank 0 : Epoch 6 | Iter 1400/1875 | Iter Train Loss = 0.061 | Iter Time = 0.583674 s
Rank 0 : Epoch 6 | Iter 1600/1875 | Iter Train Loss = 0.013 | Iter Time = 0.529875 s
Rank 0 : Epoch 6 | Iter 1800/1875 | Iter Train Loss = 0.042 | Iter Time = 0.474779 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 6 : Epoch Train Loss= 0.084 | Average Iter Time = 0.561121 s
Rank 0 : End Training ...
Rank 0 : Epoch 7 | Iter 0/1875 | Iter Train Loss = 0.010 | Iter Time = 1.101676 s
Rank 0 : Epoch 7 | Iter 200/1875 | Iter Train Loss = 0.059 | Iter Time = 0.677724 s
Rank 0 : Epoch 7 | Iter 400/1875 | Iter Train Loss = 0.045 | Iter Time = 0.639287 s
Rank 0 : Epoch 7 | Iter 600/1875 | Iter Train Loss = 0.085 | Iter Time = 0.581551 s
Rank 0 : Epoch 7 | Iter 800/1875 | Iter Train Loss = 0.093 | Iter Time = 0.528491 s
Rank 0 : Epoch 7 | Iter 1000/1875 | Iter Train Loss = 0.005 | Iter Time = 0.537429 s
Rank 0 : Epoch 7 | Iter 1200/1875 | Iter Train Loss = 0.013 | Iter Time = 0.516104 s
Rank 0 : Epoch 7 | Iter 1400/1875 | Iter Train Loss = 0.004 | Iter Time = 0.686105 s
Rank 0 : Epoch 7 | Iter 1600/1875 | Iter Train Loss = 0.025 | Iter Time = 0.617831 s
Rank 0 : Epoch 7 | Iter 1800/1875 | Iter Train Loss = 0.137 | Iter Time = 0.563779 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 7 : Epoch Train Loss= 0.079 | Average Iter Time = 0.559718 s
Rank 0 : End Training ...
Rank 0 : Epoch 8 | Iter 0/1875 | Iter Train Loss = 0.020 | Iter Time = 1.164204 s
Rank 0 : Epoch 8 | Iter 200/1875 | Iter Train Loss = 0.056 | Iter Time = 0.777980 s
Rank 0 : Epoch 8 | Iter 400/1875 | Iter Train Loss = 0.043 | Iter Time = 0.506482 s
Rank 0 : Epoch 8 | Iter 600/1875 | Iter Train Loss = 0.093 | Iter Time = 0.528077 s
Rank 0 : Epoch 8 | Iter 800/1875 | Iter Train Loss = 0.291 | Iter Time = 0.547734 s
Rank 0 : Epoch 8 | Iter 1000/1875 | Iter Train Loss = 0.011 | Iter Time = 0.670450 s
Rank 0 : Epoch 8 | Iter 1200/1875 | Iter Train Loss = 0.004 | Iter Time = 0.677247 s
Rank 0 : Epoch 8 | Iter 1400/1875 | Iter Train Loss = 0.020 | Iter Time = 0.479279 s
Rank 0 : Epoch 8 | Iter 1600/1875 | Iter Train Loss = 0.016 | Iter Time = 0.480456 s
Rank 0 : Epoch 8 | Iter 1800/1875 | Iter Train Loss = 0.037 | Iter Time = 0.505860 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 8 : Epoch Train Loss= 0.073 | Average Iter Time = 0.554160 s
Rank 0 : End Training ...
Rank 0 : Epoch 9 | Iter 0/1875 | Iter Train Loss = 0.074 | Iter Time = 1.089991 s
Rank 0 : Epoch 9 | Iter 200/1875 | Iter Train Loss = 0.133 | Iter Time = 0.570541 s
Rank 0 : Epoch 9 | Iter 400/1875 | Iter Train Loss = 0.039 | Iter Time = 0.551208 s
Rank 0 : Epoch 9 | Iter 600/1875 | Iter Train Loss = 0.007 | Iter Time = 0.601312 s
Rank 0 : Epoch 9 | Iter 800/1875 | Iter Train Loss = 0.005 | Iter Time = 0.599860 s
Rank 0 : Epoch 9 | Iter 1000/1875 | Iter Train Loss = 0.040 | Iter Time = 0.554644 s
Rank 0 : Epoch 9 | Iter 1200/1875 | Iter Train Loss = 0.004 | Iter Time = 0.530611 s
Rank 0 : Epoch 9 | Iter 1400/1875 | Iter Train Loss = 0.016 | Iter Time = 0.456317 s
Rank 0 : Epoch 9 | Iter 1600/1875 | Iter Train Loss = 0.038 | Iter Time = 0.528526 s
Rank 0 : Epoch 9 | Iter 1800/1875 | Iter Train Loss = 0.023 | Iter Time = 0.593272 s
Current Memory Usage = 0.00 GB | Peak Memory Usage = 0.00 GB
Rank 0 : Epoch 9 : Epoch Train Loss= 0.071 | Average Iter Time = 0.553318 s
Rank 0 : End Training ...
